# Fluxo da Tela de Adicionar Despesa

```
┌──────────────────────────────────────────────────────────────┐
│                    ExpensesScreen                             │
│  ┌────────────────────────────────────────────────────────┐  │
│  │  Filtros: [Ano ▼] [Mês ▼]                             │  │
│  │                                                         │  │
│  │  Lista de Despesas                                     │  │
│  │  ┌─────────────────────────────────────────┐          │  │
│  │  │ 🍔 Almoço - R$ 45,00                    │          │  │
│  │  │ 📍 Restaurante ABC                       │  [🗑️]   │  │
│  │  │ 💳 Nubank **** 1234                     │          │  │
│  │  └─────────────────────────────────────────┘          │  │
│  │                                                         │  │
│  │  [➕ Adicionar Despesa]  ←────────────┐               │  │
│  └────────────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────────────┘
                                              │
                                              │ navigation.navigate('AddExpense')
                                              ▼
┌──────────────────────────────────────────────────────────────┐
│                  AddExpenseScreen                             │
│  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓  │
│  ┃ Nova Despesa                                           ┃  │
│  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  │
│                                                               │
│  Descrição *                                                  │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ Ex: Almoço, Compras do mês, etc.                    │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                               │
│  Valor (R$) *                                                 │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ 0,00                                                 │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                               │
│  Tipo de Pagamento *                                          │
│  ┌──────────────┐ ┌──────────────┐                          │
│  │  💳          │ │  💳          │                          │
│  │ Cartão de    │ │ Cartão de    │                          │
│  │  Crédito     │ │  Débito      │                          │
│  └──────────────┘ └──────────────┘                          │
│  ┌──────────────┐ ┌──────────────┐                          │
│  │  💵          │ │  📱          │                          │
│  │  Dinheiro    │ │  PIX         │                          │
│  └──────────────┘ └──────────────┘                          │
│  ┌──────────────┐ ┌──────────────┐                          │
│  │  🏦          │ │  🧾          │                          │
│  │  Depósito    │ │  Boleto      │                          │
│  └──────────────┘ └──────────────┘                          │
│                                                               │
│  Estabelecimento *                                            │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ 🔍 Buscar estabelecimento...              ▼         │    │
│  └─────────────────────────────────────────────────────┘    │
│         │                                                     │
│         └─────────────────┐                                  │
│                           ▼                                  │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ 🍔 Restaurante ABC                                  │    │
│  │ 🛒 Supermercado XYZ                                 │    │
│  │ ⛽ Posto Shell                                      │    │
│  │                                                      │    │
│  │ [➕ Adicionar Novo Estabelecimento]  ───────┐      │    │
│  └─────────────────────────────────────────────────────┘    │
│                                              │               │
│  ┌───────────────────────────────────────────┼──────────┐   │
│  │ if (paymentType == CreditCard ||          │          │   │
│  │     paymentType == DebitCard)             │          │   │
│  │                                            │          │   │
│  │  Cartão *                                 │          │   │
│  │  ┌─────────────────────────────────────────────┐    │   │
│  │  │ 🔍 Buscar cartão...                   ▼    │    │   │
│  │  └─────────────────────────────────────────────┘    │   │
│  │         │                                            │   │
│  │         └─────────────────┐                         │   │
│  │                           ▼                         │   │
│  │  ┌─────────────────────────────────────────────┐    │   │
│  │  │ 💳 Nubank **** 1234                         │    │   │
│  │  │ 💳 Inter **** 5678                          │    │   │
│  │  │                                              │    │   │
│  │  │ [➕ Adicionar Novo Cartão]  ─────────┐     │    │   │
│  │  └─────────────────────────────────────────────┘    │   │
│  └───────────────────────────────────────────┼──────────┘   │
│                                              │               │
│  ┌───────────────────────────────────────────┼──────────┐   │
│  │ if (paymentType == CreditCard)            │          │   │
│  │                                            │          │   │
│  │  Número de Parcelas                       │          │   │
│  │  ┌─────────────────────────────────────────────┐    │   │
│  │  │ 1                                            │    │   │
│  │  └─────────────────────────────────────────────┘    │   │
│  └───────────────────────────────────────────┼──────────┘   │
│                                              │               │
│  ┌──────────────────────┐ ┌─────────────────────────────┐  │
│  │     Cancelar         │ │    Salvar Despesa           │  │
│  └──────────────────────┘ └─────────────────────────────┘  │
│                                     │                        │
│                                     │ POST /api/expenses     │
│                                     ▼                        │
│                            ┌──────────────────┐             │
│                            │  Sucesso! ✅     │             │
│                            │  Despesa criada  │             │
│                            └──────────────────┘             │
│                                     │                        │
│                                     │ navigation.goBack()    │
│                                     ▼                        │
└──────────────────────────────────────────────────────────────┘
                                     │
                                     ▼
┌──────────────────────────────────────────────────────────────┐
│                    ExpensesScreen                             │
│  (Lista recarregada automaticamente via useFocusEffect)       │
│                                                               │
│  ┌─────────────────────────────────────────┐                │
│  │ 🍔 Almoço - R$ 45,00        [Nova]      │                │
│  │ 📍 Restaurante ABC           [🗑️]      │                │
│  │ 💳 Nubank **** 1234                     │                │
│  └─────────────────────────────────────────┘                │
└──────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════
                      MODAIS INTEGRADOS
═══════════════════════════════════════════════════════════════

┌─────────────────────────────────────┐  ┌──────────────────────────────────────┐
│  AddEstablishmentModal              │  │  AddCardModal                        │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                     │  │                                      │
│  Nome do Estabelecimento *          │  │  Nome do Cartão *                    │
│  ┌───────────────────────────────┐  │  │  ┌────────────────────────────────┐ │
│  │ Ex: Restaurante, Loja         │  │  │  │ Ex: Nubank, Inter              │ │
│  └───────────────────────────────┘  │  │  └────────────────────────────────┘ │
│                                     │  │                                      │
│  Tipo *                             │  │  Tipo *                              │
│  ┌──────┐ ┌──────┐ ┌──────┐       │  │  ┌──────────┐ ┌──────────┐          │
│  │  🍔  │ │  🛒  │ │  ⛽  │       │  │  │ Crédito  │ │  Débito  │          │
│  │ Rest.│ │Super │ │Posto │       │  │  └──────────┘ └──────────┘          │
│  └──────┘ └──────┘ └──────┘       │  │  ┌──────────┐                        │
│  ... (mais opções)                  │  │  │ Voucher  │                        │
│                                     │  │  └──────────┘                        │
│  [Cancelar]  [Salvar]              │  │                                      │
│                                     │  │  Bandeira *                          │
│                                     │  │  ┌──────────────────────────────┐   │
│  ✅ Após salvar:                    │  │  │ Visa ▼                       │   │
│     - Fecha modal                   │  │  └──────────────────────────────┘   │
│     - Seleciona automaticamente     │  │                                      │
│     - Atualiza lista dropdown       │  │  Últimos 4 dígitos *                 │
│                                     │  │  ┌────────────────────────────────┐ │
└─────────────────────────────────────┘  │  │ 1234                           │ │
                                         │  └────────────────────────────────┘ │
                                         │                                      │
                                         │  [Cancelar]  [Salvar]               │
                                         │                                      │
                                         │  ✅ Após salvar:                     │
                                         │     - Fecha modal                    │
                                         │     - Seleciona automaticamente      │
                                         │     - Atualiza lista dropdown        │
                                         │                                      │
                                         └──────────────────────────────────────┘


═══════════════════════════════════════════════════════════════
                  LÓGICA DE VISIBILIDADE
═══════════════════════════════════════════════════════════════

┌──────────────────────────────────────────────────────────┐
│ Tipo de Pagamento       │ Cartão  │ Parcelas            │
│─────────────────────────┼─────────┼─────────────────────│
│ 💳 Cartão de Crédito    │ ✅ Sim  │ ✅ Sim (1-60)       │
│ 💳 Cartão de Débito     │ ✅ Sim  │ ❌ Não (padrão: 1)  │
│ 💵 Dinheiro             │ ❌ Não  │ ❌ Não (padrão: 1)  │
│ 📱 PIX                  │ ❌ Não  │ ❌ Não (padrão: 1)  │
│ 🏦 Depósito             │ ❌ Não  │ ❌ Não (padrão: 1)  │
│ 🧾 Boleto               │ ❌ Não  │ ❌ Não (padrão: 1)  │
└──────────────────────────────────────────────────────────┘

```
